{"version":3,"sources":["src/status-calculator-component.js"],"names":["BaseComponent","translate","translations","programs","template","constructor","$template","$status","connectedCallback","calculate","querySelector","value","display","data","airports","totals","el_list","innerHTML","Object","keys","map","id","program","status","filter","allianceStatus","qualification","build","type","needed","number","collected","qm","progress","milesName","milesname","$locale","$segments","length","secType","secNeeded","secNumber","secCollected","secProgress","secNote","secmilesName","secmilesname","secCalculate","flat","undefined","sort","a","b","forEach","item","el","document","createElement","text","name","note","toLocaleString","style","minimumFractionDigits","qualificationPeriod","qualificationPeriodType","validity","appendChild"],"mappings":"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","sourceRoot":"/source_map/","sourcesContent":["import BaseComponent from './base-component';\nimport translate from './helper/translate';\nimport translations from './translations';\nimport programs from './programs';\nimport template from './templates/status-calculator';\n\nexport default class extends BaseComponent {\n  constructor() {\n    super();\n    this.$template = template;\n    this.$status = 'Star Alliance Gold';\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n  }\n\n  calculate() {\n\n    this.$status = this.querySelector('[name=\"status\"]').value;\n\n    super.calculate();\n  }\n\n  display( {value: data, airports}, totals ) {\n\n    super.display();\n\n    this.el_list.innerHTML = '';\n\n    Object.keys(totals)\n      .map(id => {\n        const program = programs[id];\n        if (!program) {\n          return [];\n        }\n\n        return program.status\n          .filter(status => this.$status === status.allianceStatus)\n          .map(status => {\n            return status.qualification.map(qualification => {\n\n              let build = {\n                program,\n                status,\n                qualification,\n              };\n\n              switch(qualification.type) {\n                case 'miles': \n                  build.needed = qualification.number;\n                  build.collected = totals[id].qm[0];\n                  build.progress = build.collected / build.needed;\n                  qualification.milesName? build.milesname = qualification.milesName[this.$locale] : build.milesname = qualification.type;\n                  break;\n                case 'segments':\n                  build.needed = qualification.number;\n                  build.collected = this.$segments.length;\n                  build.progress = build.collected / build.needed;\n                  qualification.milesName? build.milesname = qualification.milesName[this.$locale] : build.milesname = qualification.type;\n\n              }\n\n              if(qualification.calculate) {\n                build.collected = qualification.calculate(this.$segments, data, airports);\n                build.progress = build.collected / build.needed;\n              }\n\n              if(qualification.secType) {\n\n                switch(qualification.secType) {\n                  case 'miles': \n                    build.secNeeded = qualification.secNumber;\n                    build.secCollected = totals[id].qm[0];\n                    build.secProgress = build.secCollected / build.secNeeded;\n                    build.secNote = qualification.secNote;\n                    qualification.secmilesName? build.secmilesname = qualification.secmilesName[this.$locale] : build.secmilesname = qualification.type;\n                    break;\n                  case 'segments':\n                    build.secNeeded = qualification.secNumber;\n                    build.secCollected = this.$segments.length;\n                    build.secProgress = build.secCollected / build.secNeeded;\n                    build.secNote = qualification.secNote;\n                    qualification.secmilesName? build.secmilesname = qualification.secmilesName[this.$locale] : build.secmilesname = qualification.type;\n\n                }\n\n                if(qualification.secCalculate) {\n                  build.secCollected = qualification.secCalculate(this.$segments, data, airports);\n                  build.secProgress = build.secCollected / build.secNeeded;\n                }\n\n              }\n\n              return build;\n            }) \n          })\n          .flat()\n          .filter(status => undefined !== typeof status.progress);\n      })\n      .flat()\n      .sort((a,b) => b.progress-a.progress )\n      .forEach(item => {\n        let el = document.createElement('li');\n        let text = `\n        <h3>${item.program.name}: ${item.status.name}</h3>\n        <div class=\"grid grid-cols-2 gap-x-4 gab-y-8 my-3\" style=\"row-gap: 1rem; column-gap: 2rem;\">\n          ${ item.program.note ? `\n          <div class=\"col-span-2 text-sm\">\n            ${ item.program.note && item.program.note[this.$locale] ? `<div>${item.program.note[this.$locale]}</div>`: '' }\n          </div>\n          ` : '' }\n          <div class=\"${'undefined' === typeof item.secProgress ? 'col-span-2 ' : ''}flex flex-col justify-end\">\n            <div class=\"text-sm\">${item.progress.toLocaleString(undefined, {style: 'percent', minimumFractionDigits: 0})} = ${item.collected.toLocaleString()} __(of) ${item.needed.toLocaleString()} __(${item.milesname})</div>\n            <progress class=\"w-full\" value=\"${item.progress}\">${item.progress.toLocaleString(undefined, {style: 'percent', minimumFractionDigits: 0})}</progress>\n          </div>\n          ${'undefined' === typeof item.secProgress ? '' : `\n          <div class=\"flex flex-col justify-end\">\n            <div class=\"text-sm\">${item.secProgress.toLocaleString(undefined, {style: 'percent', minimumFractionDigits: 0})} = ${item.secCollected.toLocaleString()} __(of) ${item.secNeeded.toLocaleString()} __(${item.secmilesname})</div>\n            <progress class=\"w-full\" value=\"${item.secProgress}\">${item.secProgress.toLocaleString(undefined, {style: 'percent', minimumFractionDigits: 0})}</progress>\n           </div>\n          `}\n          ${ item.qualification.note || item.qualification.secNote ? `\n          <div class=\"text-sm${'undefined' === typeof item.qualification.secNote ? ' col-span-2 ' : ''}\">\n            ${ item.qualification.note && item.qualification.note[this.$locale] ? `<div>${item.qualification.note[this.$locale]}</div>`: '' }\n          </div>\n          ${'undefined' !== typeof item.secProgress && item.qualification.secNote ? `\n          <div class=\"text-sm\">\n            ${ item.qualification.secNote && item.qualification.secNote[this.$locale] ? item.qualification.secNote[this.$locale] : '' }\n          </div>\n          ` : '' }\n          ` : '' }\n          ${ item.status.note ? `\n          <div class=\"col-span-2 text-sm\">\n            ${ item.status.note && item.status.note[this.$locale] ? `<div>${item.status.note[this.$locale]}</div>`: '' }\n          </div>\n          ` : '' }\n          <div class=\"text-center\">\n            <div class=\"text-sm\">__(Qualification period)</div>\n            <div>${item.qualification.qualificationPeriod} __(months)</div>\n            <div class=\"text-sm\">__(${item.program.qualificationPeriodType})</div>\n          </div>\n          <div class=\"text-center\">\n            <div class=\"text-sm\">__(Validity)</div>\n            <div>__(at least) ${item.qualification.validity} __(months)</div>\n          </div>\n        </div>\n        `;\n\n        el.innerHTML = translate(text, translations[this.$locale] ? translations[this.$locale] : []);\n        this.el_list.appendChild(el);\n      });\n\n  }\n\n}"]}