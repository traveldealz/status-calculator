{"version":3,"names":["template","translate","translations","HTMLElement","constructor","$template","$segments","connectedCallback","$locale","hasAttribute","getAttribute","navigator","language","split","$currency","renderTemplate","el_route","querySelector","el_list","el_button","el_loading","el_error","addEventListener","event","preventDefault","loading_start","calculate","innerHTML","replaceAll","location","hash","loadParameters","itineraries","value","trim","map","parts","v","carrier","bookingClass","route","ticketer","price","currency","match","reduce","accumulator","airport","index","push","origin","destination","parseInt","flat","update_hash","query","elem","warningSpan","document","createElement","className","parentNode","insertBefore","body","JSON","stringify","itinerary","ticketingCarrier","baseFare","segments","Promise","all","fetch","method","headers","then","responses","response","json","merge_responses","calculate_totals","catch","error","loading_end","toString","classList","remove","td_data","wtc_data","success","Error","errorMessage","segment","segmentIndex","ids","Set","totals","program","id","wtc_total","find","item","qm","rdm","qd","forEach","m","i","display","data","disabled","add","searchParams","URLSearchParams","replace","el","key","keys","type","checked","get","parameters","querySelectorAll","name"],"sourceRoot":"/source_map/","sources":["src/base-component.js"],"sourcesContent":["import template from \"./templates/base\";\nimport translate from \"./helper/translate\";\nimport translations from \"./translations\";\n\nexport default class extends HTMLElement {\n  constructor() {\n    super();\n    this.$template = template;\n    this.$segments = [];\n  }\n\n  connectedCallback() {\n    this.$locale = this.hasAttribute(\"locale\")\n      ? this.getAttribute(\"locale\")\n      : navigator.language\n      ? navigator.language\n      : \"en\";\n    this.$locale = this.$locale.split(\"-\")[0];\n    this.$locale = translations[this.$locale] ? this.$locale : \"en\";\n\n    this.$currency = this.hasAttribute(\"currency\")\n      ? this.getAttribute(\"currency\")\n      : \"EUR\";\n\n    this.renderTemplate();\n\n    this.el_route = this.querySelector('[name=\"route\"]');\n    this.el_list = this.querySelector(\"#list\");\n    this.el_button = this.querySelector('button[type=\"submit\"]');\n    this.el_loading = this.querySelector(\".loading\");\n    this.el_error = this.querySelector(\".error\");\n\n    this.querySelector(\"form\").addEventListener(\"submit\", (event) => {\n      event.preventDefault();\n      this.loading_start();\n      this.calculate();\n    });\n\n    if (this.hasAttribute(\"route\")) {\n      this.querySelector('[name=\"route\"]').innerHTML = this.getAttribute(\n        \"route\"\n      ).replaceAll(\",\", \"\\n\");\n    }\n\n    if (location.hash) {\n      this.loadParameters();\n    }\n  }\n\n  renderTemplate() {\n    this.innerHTML = translate(\n      this.$template,\n      translations[this.$locale] ? translations[this.$locale] : []\n    );\n  }\n\n  calculate() {\n    let itineraries = this.el_route.value\n      .trim()\n      .split(\"\\n\")\n      .map((value) => {\n        let parts = value.split(\":\").map((v) => v.trim());\n        let carrier = parts[0];\n        let bookingClass = parts[1];\n        let route = parts[2].split(\"-\").map((v) => v.trim());\n        let ticketer = parts[3];\n        let price = parts[4];\n        let currency =\n          parts[4] && parts[4].match(/[A-Z]{3}|[$€£]/u)\n            ? parts[4].match(/[A-Z]{3}|[$€£]/u)[0]\n            : this.$currency;\n\n        return route.reduce((accumulator, airport, index, route) => {\n          if (0 === index || !accumulator) {\n            return accumulator;\n          }\n          accumulator.push({\n            carrier,\n            bookingClass,\n            origin: route[index - 1],\n            destination: airport,\n            ticketer,\n            price: index == 1 ? parseInt(price) : 0,\n            currency,\n          });\n          return accumulator;\n        }, []);\n      })\n      .flat();\n    this.$segments = itineraries.flat();\n    this.update_hash();\n    this.query(itineraries);\n\n    for (elem in this.$segments.carrier) {\n      if (elem.carrier == \"AY\") {\n        var warningSpan = document.createElement(\"span\");\n        warningSpan.className = \"redTextClass\";\n        warningSpan.innerHTML =\n          \"Leider können wir die Finnair-Plus-Punkte für Finnair-Flüge nicht berechnen\";\n        this.parentNode.insertBefore(warningSpan, this);\n        //alert('Leider können wir die Finnair-Plus-Punkte für Finnair-Flüge nicht berechnen' );\n      }\n    }\n  }\n\n  async query(itineraries) {\n    let body = JSON.stringify(\n      itineraries.map((itinerary) => {\n        return {\n          ...(itinerary.ticketer\n            ? { ticketingCarrier: itinerary.ticketer }\n            : {}),\n          ...(itinerary.price || itinerary.price === 0\n            ? { baseFare: itinerary.price, currency: itinerary.currency }\n            : {}),\n          segments: [itinerary],\n        };\n      })\n    );\n\n    Promise.all([\n      fetch(\"https://mileage.travel-dealz.eu/api/calculate/mileage\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body,\n      }),\n      fetch(\"https://www.wheretocredit.com/api/2.0/calculate\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body,\n      }),\n    ])\n      .then((responses) =>\n        Promise.all(responses.map((response) => response.json()))\n      )\n      .then((responses) => this.merge_responses(responses[0], responses[1]))\n      .then((response) => this.calculate_totals(response))\n      .catch((error) => {\n        this.loading_end();\n        this.el_error.innerHTML = `${error.toString()}`;\n        this.el_error.classList.remove(\"hidden\");\n      });\n  }\n\n  merge_responses(td_data, wtc_data) {\n    if (wtc_data.success == false) {\n      throw Error(wtc_data.errorMessage);\n    }\n    if (td_data.success == false) {\n      throw Error(td_data.errorMessage);\n    }\n    let response = {\n      ...wtc_data,\n      ...td_data,\n    };\n\n    if (false === wtc_data.success && true === response.success) {\n      response.success = wtc_data.success;\n      response.errorMessage = wtc_data.errorMessage;\n    }\n\n    response.value = response.value.map((segment, segmentIndex) => {\n      segment = {\n        ...segment,\n\n        value: {\n          ...(wtc_data.value[segmentIndex].value\n            ? wtc_data.value[segmentIndex].value\n            : {}),\n          ...segment.value,\n        },\n      };\n\n      if (\n        false === wtc_data.value[segmentIndex].success &&\n        true === segment.success\n      ) {\n        segment.success = wtc_data.value[segmentIndex].success;\n        segment.errorMessage = wtc_data.value[segmentIndex].errorMessage;\n      }\n\n      let ids = [\n        ...new Set([\n          ...segment.value.totals.map((program) => program.id),\n          ...(wtc_data.value[segmentIndex].value\n            ? wtc_data.value[segmentIndex].value.totals.map(\n                (program) => program.id\n              )\n            : []),\n        ]),\n      ];\n\n      let totals = ids.map((program) => {\n        let wtc_total = wtc_data.value[segmentIndex].value?.totals?.find(\n          (item) => program === item.id\n        )\n          ? wtc_data.value[segmentIndex].value.totals.find(\n              (item) => program === item.id\n            )\n          : {};\n        return {\n          ...wtc_total,\n          qm: wtc_total.rdm ? wtc_total.rdm : [0, 0, 0, 0],\n          qd: wtc_total.qd ? wtc_total.qd : 0,\n          ...segment.value.totals.find((item) => program === item.id),\n        };\n      });\n\n      segment.value.totals = totals;\n\n      return segment;\n    });\n\n    if (false === response.success) {\n      throw response.errorMessage;\n    }\n\n    response.value.forEach((item) => {\n      if (false === item.success) {\n        throw item.errorMessage;\n      }\n    });\n\n    return response;\n  }\n\n  calculate_totals(response) {\n    let totals = response.value.reduce((totals, itinerary) => {\n      itinerary.value.totals.forEach((item) => {\n        item.rdm\n          ? (totals[item.id] = totals[item.id]\n              ? {\n                  rdm: totals[item.id].rdm\n                    ? totals[item.id].rdm.map((m, i) => m + item.rdm[i])\n                    : item.rdm,\n                  qm: totals[item.id].qm.map((m, i) => m + item.qm[i]),\n                  qd: totals[item.id].qd + item.qd,\n                }\n              : {\n                  rdm: item.rdm,\n                  qm: item.qm,\n                  qd: item.qd,\n                })\n          : {};\n      });\n\n      return totals;\n    }, {});\n\n    this.display(response, totals);\n  }\n\n  display(data, totals) {\n    this.loading_end();\n  }\n\n  loading_start() {\n    this.el_button.disabled = true;\n    this.el_list.innerHTML = \"\";\n    this.el_loading.classList.remove(\"hidden\");\n    this.el_error.classList.add(\"hidden\");\n    this.el_error.innerHTML = \"\";\n  }\n\n  loading_end() {\n    this.el_button.disabled = false;\n    this.el_loading.classList.add(\"hidden\");\n  }\n\n  loadParameters() {\n    let searchParams = new URLSearchParams(location.hash.replace(\"#\", \"\"));\n    let el = {};\n    for (let key of searchParams.keys()) {\n      el = this.querySelector(`[name=\"${key}\"]`);\n      if (el) {\n        \"checkbox\" === el.type\n          ? (el.checked = \"true\" === searchParams.get(key))\n          : (el.value = searchParams.get(key));\n      }\n    }\n  }\n\n  update_hash() {\n    let parameters = {};\n    [...this.querySelectorAll(\"[name]\")].forEach(\n      (el) =>\n        (parameters[el.name] = \"checkbox\" === el.type ? el.checked : el.value)\n    );\n    location.hash = new URLSearchParams(parameters).toString();\n  }\n}\n"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,kBAArB;AACA,OAAOC,SAAP,MAAsB,oBAAtB;AACA,OAAOC,YAAP,MAAyB,gBAAzB;AAEA,eAAe,cAAcC,WAAd,CAA0B;EACvCC,WAAW,GAAG;IACZ;IACA,KAAKC,SAAL,GAAiBL,QAAjB;IACA,KAAKM,SAAL,GAAiB,EAAjB;EACD;;EAEDC,iBAAiB,GAAG;IAClB,KAAKC,OAAL,GAAe,KAAKC,YAAL,CAAkB,QAAlB,IACX,KAAKC,YAAL,CAAkB,QAAlB,CADW,GAEXC,SAAS,CAACC,QAAV,GACAD,SAAS,CAACC,QADV,GAEA,IAJJ;IAKA,KAAKJ,OAAL,GAAe,KAAKA,OAAL,CAAaK,KAAb,CAAmB,GAAnB,EAAwB,CAAxB,CAAf;IACA,KAAKL,OAAL,GAAeN,YAAY,CAAC,KAAKM,OAAN,CAAZ,GAA6B,KAAKA,OAAlC,GAA4C,IAA3D;IAEA,KAAKM,SAAL,GAAiB,KAAKL,YAAL,CAAkB,UAAlB,IACb,KAAKC,YAAL,CAAkB,UAAlB,CADa,GAEb,KAFJ;IAIA,KAAKK,cAAL;IAEA,KAAKC,QAAL,GAAgB,KAAKC,aAAL,CAAmB,gBAAnB,CAAhB;IACA,KAAKC,OAAL,GAAe,KAAKD,aAAL,CAAmB,OAAnB,CAAf;IACA,KAAKE,SAAL,GAAiB,KAAKF,aAAL,CAAmB,uBAAnB,CAAjB;IACA,KAAKG,UAAL,GAAkB,KAAKH,aAAL,CAAmB,UAAnB,CAAlB;IACA,KAAKI,QAAL,GAAgB,KAAKJ,aAAL,CAAmB,QAAnB,CAAhB;IAEA,KAAKA,aAAL,CAAmB,MAAnB,EAA2BK,gBAA3B,CAA4C,QAA5C,EAAuDC,KAAD,IAAW;MAC/DA,KAAK,CAACC,cAAN;MACA,KAAKC,aAAL;MACA,KAAKC,SAAL;IACD,CAJD;;IAMA,IAAI,KAAKjB,YAAL,CAAkB,OAAlB,CAAJ,EAAgC;MAC9B,KAAKQ,aAAL,CAAmB,gBAAnB,EAAqCU,SAArC,GAAiD,KAAKjB,YAAL,CAC/C,OAD+C,EAE/CkB,UAF+C,CAEpC,GAFoC,EAE/B,IAF+B,CAAjD;IAGD;;IAED,IAAIC,QAAQ,CAACC,IAAb,EAAmB;MACjB,KAAKC,cAAL;IACD;EACF;;EAEDhB,cAAc,GAAG;IACf,KAAKY,SAAL,GAAiB1B,SAAS,CACxB,KAAKI,SADmB,EAExBH,YAAY,CAAC,KAAKM,OAAN,CAAZ,GAA6BN,YAAY,CAAC,KAAKM,OAAN,CAAzC,GAA0D,EAFlC,CAA1B;EAID;;EAEDkB,SAAS,GAAG;IACV,IAAIM,WAAW,GAAG,KAAKhB,QAAL,CAAciB,KAAd,CACfC,IADe,GAEfrB,KAFe,CAET,IAFS,EAGfsB,GAHe,CAGVF,KAAD,IAAW;MACd,IAAIG,KAAK,GAAGH,KAAK,CAACpB,KAAN,CAAY,GAAZ,EAAiBsB,GAAjB,CAAsBE,CAAD,IAAOA,CAAC,CAACH,IAAF,EAA5B,CAAZ;MACA,IAAII,OAAO,GAAGF,KAAK,CAAC,CAAD,CAAnB;MACA,IAAIG,YAAY,GAAGH,KAAK,CAAC,CAAD,CAAxB;MACA,IAAII,KAAK,GAAGJ,KAAK,CAAC,CAAD,CAAL,CAASvB,KAAT,CAAe,GAAf,EAAoBsB,GAApB,CAAyBE,CAAD,IAAOA,CAAC,CAACH,IAAF,EAA/B,CAAZ;MACA,IAAIO,QAAQ,GAAGL,KAAK,CAAC,CAAD,CAApB;MACA,IAAIM,KAAK,GAAGN,KAAK,CAAC,CAAD,CAAjB;MACA,IAAIO,QAAQ,GACVP,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAL,CAASQ,KAAT,CAAe,iBAAf,CAAZ,GACIR,KAAK,CAAC,CAAD,CAAL,CAASQ,KAAT,CAAe,iBAAf,EAAkC,CAAlC,CADJ,GAEI,KAAK9B,SAHX;MAKA,OAAO0B,KAAK,CAACK,MAAN,CAAa,CAACC,WAAD,EAAcC,OAAd,EAAuBC,KAAvB,EAA8BR,KAA9B,KAAwC;QAC1D,IAAI,MAAMQ,KAAN,IAAe,CAACF,WAApB,EAAiC;UAC/B,OAAOA,WAAP;QACD;;QACDA,WAAW,CAACG,IAAZ,CAAiB;UACfX,OADe;UAEfC,YAFe;UAGfW,MAAM,EAAEV,KAAK,CAACQ,KAAK,GAAG,CAAT,CAHE;UAIfG,WAAW,EAAEJ,OAJE;UAKfN,QALe;UAMfC,KAAK,EAAEM,KAAK,IAAI,CAAT,GAAaI,QAAQ,CAACV,KAAD,CAArB,GAA+B,CANvB;UAOfC;QAPe,CAAjB;QASA,OAAOG,WAAP;MACD,CAdM,EAcJ,EAdI,CAAP;IAeD,CA9Be,EA+BfO,IA/Be,EAAlB;IAgCA,KAAK/C,SAAL,GAAiB0B,WAAW,CAACqB,IAAZ,EAAjB;IACA,KAAKC,WAAL;IACA,KAAKC,KAAL,CAAWvB,WAAX;;IAEA,KAAKwB,IAAL,IAAa,KAAKlD,SAAL,CAAegC,OAA5B,EAAqC;MACnC,IAAIkB,IAAI,CAAClB,OAAL,IAAgB,IAApB,EAA0B;QACxB,IAAImB,WAAW,GAAGC,QAAQ,CAACC,aAAT,CAAuB,MAAvB,CAAlB;QACAF,WAAW,CAACG,SAAZ,GAAwB,cAAxB;QACAH,WAAW,CAAC9B,SAAZ,GACE,6EADF;QAEA,KAAKkC,UAAL,CAAgBC,YAAhB,CAA6BL,WAA7B,EAA0C,IAA1C,EALwB,CAMxB;MACD;IACF;EACF;;EAEU,MAALF,KAAK,CAACvB,WAAD,EAAc;IACvB,IAAI+B,IAAI,GAAGC,IAAI,CAACC,SAAL,CACTjC,WAAW,CAACG,GAAZ,CAAiB+B,SAAD,IAAe;MAC7B,OAAO,EACL,IAAIA,SAAS,CAACzB,QAAV,GACA;UAAE0B,gBAAgB,EAAED,SAAS,CAACzB;QAA9B,CADA,GAEA,EAFJ,CADK;QAIL,IAAIyB,SAAS,CAACxB,KAAV,IAAmBwB,SAAS,CAACxB,KAAV,KAAoB,CAAvC,GACA;UAAE0B,QAAQ,EAAEF,SAAS,CAACxB,KAAtB;UAA6BC,QAAQ,EAAEuB,SAAS,CAACvB;QAAjD,CADA,GAEA,EAFJ,CAJK;QAOL0B,QAAQ,EAAE,CAACH,SAAD;MAPL,CAAP;IASD,CAVD,CADS,CAAX;IAcAI,OAAO,CAACC,GAAR,CAAY,CACVC,KAAK,CAAC,uDAAD,EAA0D;MAC7DC,MAAM,EAAE,MADqD;MAE7DC,OAAO,EAAE;QACP,gBAAgB;MADT,CAFoD;MAK7DX;IAL6D,CAA1D,CADK,EAQVS,KAAK,CAAC,iDAAD,EAAoD;MACvDC,MAAM,EAAE,MAD+C;MAEvDC,OAAO,EAAE;QACP,gBAAgB;MADT,CAF8C;MAKvDX;IALuD,CAApD,CARK,CAAZ,EAgBGY,IAhBH,CAgBSC,SAAD,IACJN,OAAO,CAACC,GAAR,CAAYK,SAAS,CAACzC,GAAV,CAAe0C,QAAD,IAAcA,QAAQ,CAACC,IAAT,EAA5B,CAAZ,CAjBJ,EAmBGH,IAnBH,CAmBSC,SAAD,IAAe,KAAKG,eAAL,CAAqBH,SAAS,CAAC,CAAD,CAA9B,EAAmCA,SAAS,CAAC,CAAD,CAA5C,CAnBvB,EAoBGD,IApBH,CAoBSE,QAAD,IAAc,KAAKG,gBAAL,CAAsBH,QAAtB,CApBtB,EAqBGI,KArBH,CAqBUC,KAAD,IAAW;MAChB,KAAKC,WAAL;MACA,KAAK9D,QAAL,CAAcM,SAAd,GAA2B,GAAEuD,KAAK,CAACE,QAAN,EAAiB,EAA9C;MACA,KAAK/D,QAAL,CAAcgE,SAAd,CAAwBC,MAAxB,CAA+B,QAA/B;IACD,CAzBH;EA0BD;;EAEDP,eAAe,CAACQ,OAAD,EAAUC,QAAV,EAAoB;IACjC,IAAIA,QAAQ,CAACC,OAAT,IAAoB,KAAxB,EAA+B;MAC7B,MAAMC,KAAK,CAACF,QAAQ,CAACG,YAAV,CAAX;IACD;;IACD,IAAIJ,OAAO,CAACE,OAAR,IAAmB,KAAvB,EAA8B;MAC5B,MAAMC,KAAK,CAACH,OAAO,CAACI,YAAT,CAAX;IACD;;IACD,IAAId,QAAQ,GAAG,EACb,GAAGW,QADU;MAEb,GAAGD;IAFU,CAAf;;IAKA,IAAI,UAAUC,QAAQ,CAACC,OAAnB,IAA8B,SAASZ,QAAQ,CAACY,OAApD,EAA6D;MAC3DZ,QAAQ,CAACY,OAAT,GAAmBD,QAAQ,CAACC,OAA5B;MACAZ,QAAQ,CAACc,YAAT,GAAwBH,QAAQ,CAACG,YAAjC;IACD;;IAEDd,QAAQ,CAAC5C,KAAT,GAAiB4C,QAAQ,CAAC5C,KAAT,CAAeE,GAAf,CAAmB,CAACyD,OAAD,EAAUC,YAAV,KAA2B;MAC7DD,OAAO,GAAG,EACR,GAAGA,OADK;QAGR3D,KAAK,EAAE,EACL,IAAIuD,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAA7B,GACAuD,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAD7B,GAEA,EAFJ,CADK;UAIL,GAAG2D,OAAO,CAAC3D;QAJN;MAHC,CAAV;;MAWA,IACE,UAAUuD,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6BJ,OAAvC,IACA,SAASG,OAAO,CAACH,OAFnB,EAGE;QACAG,OAAO,CAACH,OAAR,GAAkBD,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6BJ,OAA/C;QACAG,OAAO,CAACD,YAAR,GAAuBH,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6BF,YAApD;MACD;;MAED,IAAIG,GAAG,GAAG,CACR,GAAG,IAAIC,GAAJ,CAAQ,CACT,GAAGH,OAAO,CAAC3D,KAAR,CAAc+D,MAAd,CAAqB7D,GAArB,CAA0B8D,OAAD,IAAaA,OAAO,CAACC,EAA9C,CADM,EAET,IAAIV,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAA7B,GACAuD,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAA7B,CAAmC+D,MAAnC,CAA0C7D,GAA1C,CACG8D,OAAD,IAAaA,OAAO,CAACC,EADvB,CADA,GAIA,EAJJ,CAFS,CAAR,CADK,CAAV;MAWA,IAAIF,MAAM,GAAGF,GAAG,CAAC3D,GAAJ,CAAS8D,OAAD,IAAa;QAChC,IAAIE,SAAS,GAAGX,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAA7B,EAAoC+D,MAApC,EAA4CI,IAA5C,CACbC,IAAD,IAAUJ,OAAO,KAAKI,IAAI,CAACH,EADb,IAGZV,QAAQ,CAACvD,KAAT,CAAe4D,YAAf,EAA6B5D,KAA7B,CAAmC+D,MAAnC,CAA0CI,IAA1C,CACGC,IAAD,IAAUJ,OAAO,KAAKI,IAAI,CAACH,EAD7B,CAHY,GAMZ,EANJ;QAOA,OAAO,EACL,GAAGC,SADE;UAELG,EAAE,EAAEH,SAAS,CAACI,GAAV,GAAgBJ,SAAS,CAACI,GAA1B,GAAgC,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,EAAU,CAAV,CAF/B;UAGLC,EAAE,EAAEL,SAAS,CAACK,EAAV,GAAeL,SAAS,CAACK,EAAzB,GAA8B,CAH7B;UAIL,GAAGZ,OAAO,CAAC3D,KAAR,CAAc+D,MAAd,CAAqBI,IAArB,CAA2BC,IAAD,IAAUJ,OAAO,KAAKI,IAAI,CAACH,EAArD;QAJE,CAAP;MAMD,CAdY,CAAb;MAgBAN,OAAO,CAAC3D,KAAR,CAAc+D,MAAd,GAAuBA,MAAvB;MAEA,OAAOJ,OAAP;IACD,CAlDgB,CAAjB;;IAoDA,IAAI,UAAUf,QAAQ,CAACY,OAAvB,EAAgC;MAC9B,MAAMZ,QAAQ,CAACc,YAAf;IACD;;IAEDd,QAAQ,CAAC5C,KAAT,CAAewE,OAAf,CAAwBJ,IAAD,IAAU;MAC/B,IAAI,UAAUA,IAAI,CAACZ,OAAnB,EAA4B;QAC1B,MAAMY,IAAI,CAACV,YAAX;MACD;IACF,CAJD;IAMA,OAAOd,QAAP;EACD;;EAEDG,gBAAgB,CAACH,QAAD,EAAW;IACzB,IAAImB,MAAM,GAAGnB,QAAQ,CAAC5C,KAAT,CAAeY,MAAf,CAAsB,CAACmD,MAAD,EAAS9B,SAAT,KAAuB;MACxDA,SAAS,CAACjC,KAAV,CAAgB+D,MAAhB,CAAuBS,OAAvB,CAAgCJ,IAAD,IAAU;QACvCA,IAAI,CAACE,GAAL,GACKP,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,GAAkBF,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,GACf;UACEK,GAAG,EAAEP,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,CAAgBK,GAAhB,GACDP,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,CAAgBK,GAAhB,CAAoBpE,GAApB,CAAwB,CAACuE,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGL,IAAI,CAACE,GAAL,CAASI,CAAT,CAAtC,CADC,GAEDN,IAAI,CAACE,GAHX;UAIED,EAAE,EAAEN,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,CAAgBI,EAAhB,CAAmBnE,GAAnB,CAAuB,CAACuE,CAAD,EAAIC,CAAJ,KAAUD,CAAC,GAAGL,IAAI,CAACC,EAAL,CAAQK,CAAR,CAArC,CAJN;UAKEH,EAAE,EAAER,MAAM,CAACK,IAAI,CAACH,EAAN,CAAN,CAAgBM,EAAhB,GAAqBH,IAAI,CAACG;QALhC,CADe,GAQf;UACED,GAAG,EAAEF,IAAI,CAACE,GADZ;UAEED,EAAE,EAAED,IAAI,CAACC,EAFX;UAGEE,EAAE,EAAEH,IAAI,CAACG;QAHX,CATR,GAcI,EAdJ;MAeD,CAhBD;MAkBA,OAAOR,MAAP;IACD,CApBY,EAoBV,EApBU,CAAb;IAsBA,KAAKY,OAAL,CAAa/B,QAAb,EAAuBmB,MAAvB;EACD;;EAEDY,OAAO,CAACC,IAAD,EAAOb,MAAP,EAAe;IACpB,KAAKb,WAAL;EACD;;EAED1D,aAAa,GAAG;IACd,KAAKN,SAAL,CAAe2F,QAAf,GAA0B,IAA1B;IACA,KAAK5F,OAAL,CAAaS,SAAb,GAAyB,EAAzB;IACA,KAAKP,UAAL,CAAgBiE,SAAhB,CAA0BC,MAA1B,CAAiC,QAAjC;IACA,KAAKjE,QAAL,CAAcgE,SAAd,CAAwB0B,GAAxB,CAA4B,QAA5B;IACA,KAAK1F,QAAL,CAAcM,SAAd,GAA0B,EAA1B;EACD;;EAEDwD,WAAW,GAAG;IACZ,KAAKhE,SAAL,CAAe2F,QAAf,GAA0B,KAA1B;IACA,KAAK1F,UAAL,CAAgBiE,SAAhB,CAA0B0B,GAA1B,CAA8B,QAA9B;EACD;;EAEDhF,cAAc,GAAG;IACf,IAAIiF,YAAY,GAAG,IAAIC,eAAJ,CAAoBpF,QAAQ,CAACC,IAAT,CAAcoF,OAAd,CAAsB,GAAtB,EAA2B,EAA3B,CAApB,CAAnB;IACA,IAAIC,EAAE,GAAG,EAAT;;IACA,KAAK,IAAIC,GAAT,IAAgBJ,YAAY,CAACK,IAAb,EAAhB,EAAqC;MACnCF,EAAE,GAAG,KAAKlG,aAAL,CAAoB,UAASmG,GAAI,IAAjC,CAAL;;MACA,IAAID,EAAJ,EAAQ;QACN,eAAeA,EAAE,CAACG,IAAlB,GACKH,EAAE,CAACI,OAAH,GAAa,WAAWP,YAAY,CAACQ,GAAb,CAAiBJ,GAAjB,CAD7B,GAEKD,EAAE,CAAClF,KAAH,GAAW+E,YAAY,CAACQ,GAAb,CAAiBJ,GAAjB,CAFhB;MAGD;IACF;EACF;;EAED9D,WAAW,GAAG;IACZ,IAAImE,UAAU,GAAG,EAAjB;IACA,CAAC,GAAG,KAAKC,gBAAL,CAAsB,QAAtB,CAAJ,EAAqCjB,OAArC,CACGU,EAAD,IACGM,UAAU,CAACN,EAAE,CAACQ,IAAJ,CAAV,GAAsB,eAAeR,EAAE,CAACG,IAAlB,GAAyBH,EAAE,CAACI,OAA5B,GAAsCJ,EAAE,CAAClF,KAFpE;IAIAJ,QAAQ,CAACC,IAAT,GAAgB,IAAImF,eAAJ,CAAoBQ,UAApB,EAAgCrC,QAAhC,EAAhB;EACD;;AAjSsC"}