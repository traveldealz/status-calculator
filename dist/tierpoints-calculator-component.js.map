{"version":3,"sources":["src/tierpoints-calculator-component.js"],"names":["BaseComponent","translate","translations","template","constructor","$template","$program","$alliance","getPrograms","response","length","fetch","then","json","data","reduce","programs","item","code","$programs","buildOptions","progs","el_program","querySelector","programm","Object","entries","el_option","document","createElement","value","innerHTML","name","appendChild","tmpAry","Array","i","options","text","sort","op","Option","option","selected","el_tier","en","tiers","forEach","status","index","change","addEventListener","e","target","update_table","event","el_status","$value","undefined","display","$totals","connectedCallback","hasAttribute","getAttribute","airlines","airports","totals","console","log","$locale","el_list","totalqm","totalrm","el_thead","rm_label","rdm","qm_label","qm","status_key","cabinclass","Y","W","C","F","$segments","segment","earning","find","id","rd_status_key","qm_status_key","el","distance","toLocaleString","origin","location","destination","carrier","bookingClass","bookingclass","fare","success","errorMessage","el_foot"],"mappings":"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","sourceRoot":"/source_map/","sourcesContent":["import BaseComponent from \"./base-component\";\nimport translate from \"./helper/translate\";\nimport translations from \"./translations\";\nimport template from \"./templates/tierpoints-calculator\";\n\nexport default class extends BaseComponent {\n  constructor() {\n    super();\n    this.$template = template;\n    this.$program;\n    this.$alliance;\n  }\n\n  async getPrograms() {\n    let response;\n    if (this.$alliance.length > 3) {\n      response = await fetch(\n        \"https://mileage.travel-dealz.eu/api/airline_programs?include=airlines&filter[has_qualification]=true&filter[alliance]=\" +\n          this.$alliance\n      )\n        .then((response) => response.json())\n        .then((data) =>\n          data.reduce((programs, item) => {\n            programs[item.code] = item;\n            return programs;\n          }, {})\n        )\n        .then((programs) => (this.$programs = programs));\n    } else {\n      response = await fetch(\n        \"https://mileage.travel-dealz.eu/api/airline_programs?include=airlines&filter[has_qualification]=true&filter[code]=\" +\n          this.$alliance\n      )\n        .then((response) => response.json())\n        .then((data) =>\n          data.reduce((programs, item) => {\n            programs[item.code] = item;\n            return programs;\n          }, {})\n        )\n        .then((programs) => (this.$programs = programs));\n    }\n    return await response;\n  }\n\n  async buildOptions() {\n    this.progs = await this.getPrograms();\n    let progs = this.progs;\n    this.el_program = this.querySelector('[name=\"program\"]');\n    for (const programm of Object.entries(this.progs)) {\n      let el_option = document.createElement(\"option\");\n      el_option.value = programm[0];\n      el_option.innerHTML = programm[1].name;\n      this.el_program.appendChild(el_option);\n    }\n\n    var tmpAry = new Array();\n    for (var i = 0; i < this.el_program.options.length; i++) {\n      tmpAry[i] = new Array();\n      tmpAry[i][0] = this.el_program.options[i].text;\n      tmpAry[i][1] = this.el_program.options[i].value;\n    }\n    tmpAry.sort();\n    while (this.el_program.options.length > 0) {\n      this.el_program.options[0] = null;\n    }\n    for (var i = 0; i < tmpAry.length; i++) {\n      var op = new Option(tmpAry[i][0], tmpAry[i][1]);\n      this.el_program.options[i] = op;\n    }\n\n    for (const option of this.el_program) {\n      if (option.value == this.$program) {\n        option.selected = true;\n      }\n    }\n\n    let el_tier = this.querySelector('[name=\"status\"]');\n    for (const programm of Object.entries(progs)) {\n      if (this.$program === programm[0]) {\n        programm[1].translations.en.tiers.forEach((status, index) => {\n          let el_option = document.createElement(\"option\");\n          el_option.value = index;\n          el_option.innerHTML = status;\n          el_tier.appendChild(el_option);\n        });\n      }\n    }\n    let change = this;\n    this.querySelector('[name=\"program\"]').addEventListener(\n      \"change\",\n      function (e) {\n        el_tier.options.length = 0;\n        for (const programm of Object.entries(progs)) {\n          if (e.target.value === programm[0]) {\n            programm[1].translations.en.tiers.forEach((status, index) => {\n              let el_option = document.createElement(\"option\");\n              el_option.value = index;\n              el_option.innerHTML = status;\n              el_tier.appendChild(el_option);\n            });\n          }\n        }\n        change.update_table();\n      }\n    );\n\n    this.querySelector('[name=\"status\"]').addEventListener(\n      \"change\",\n      (event) => {\n        this.update_table();\n      }\n    );\n\n    this.$program = this.querySelector('[name=\"program\"]');\n    this.el_status = this.querySelector('[name=\"status\"]');\n  }\n\n  update_table() {\n    if (this.$value != undefined) {\n      this.display(this.$value, this.$totals);\n    }\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    this.$program = this.hasAttribute(\"program\")\n      ? this.getAttribute(\"program\")\n      : \"BA\";\n    this.$alliance = this.hasAttribute(\"alliance\")\n      ? this.getAttribute(\"alliance\")\n      : \"\";\n    this.buildOptions();\n  }\n\n  /*\n  async query(itineraries) {\n    //for (var i = 0; i < itineraries.length; i++) {\n    //  if (i > 0) {\n    //console.log(itineraries[i]);\n    //    itineraries[i].price = 0;\n    //  }\n    //}\n    let body = JSON.stringify(\n      itineraries.map((itinerary) => {\n        return {\n          ...(itinerary.ticketer\n            ? { ticketingCarrier: itinerary.ticketer }\n            : { ticketingCarrier: \"null\" }),\n          ...(itinerary.price\n            ? { baseFare: itinerary.price, currency: itinerary.currency }\n            : { baseFare: 0 }),\n          segments: [itinerary],\n        };\n      })\n    );\n\n    fetch(\n      \"https://mileage.travel-dealz.eu/api/calculate/mileage?programs=\" +\n        this.$program.value,\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body,\n      }\n    )\n      .then((response) => response.json())\n      .then((response) => this.calculate_totals(response));\n    // .catch(error => {\n    //   this.loading_end();\n    //   this.el_error.innerHTML = `Error: ${error.toString()}`;\n    //   this.el_error.classList.remove('hidden');\n    // });\n  }*/\n\n  display({ value: data, airlines, airports }, totals) {\n    this.$value = { value: data, airlines, airports };\n    console.log(this.$value);\n\n    this.$totals = totals;\n\n    super.display();\n    this.$locale !== (\"en\" && \"de\" && \"es\") ? (this.$locale = \"en\") : {};\n\n    this.el_list.innerHTML = \"\";\n    let totalqm = 0;\n    let totalrm = 0;\n    let el_thead = document.createElement(\"thead\");\n    this.rm_label =\n      this.progs[this.$program.value].translations[this.$locale].rdm;\n    this.qm_label =\n      this.progs[this.$program.value].translations[this.$locale].qm;\n    console.log(this.rm_label);\n    console.log(this.qm_label);\n    el_thead.innerHTML = translate(\n      /*html*/ `\n      <tr>\n        <th></th>\n        <th class=\"text-center\">__(Route)</th>\n        <th class=\"text-center\">__(Booking Class)</th>\n        <th class=\"text-right\">${\n          this.rm_label ? this.rm_label : \"__(Award Miles)\"\n        }</th>\n        <th class=\"text-right\">${\n          this.qm_label ? this.qm_label : \"__(Status Miles)\"\n        }</th>\n      </tr>\n    `,\n      translations[this.$locale]\n        ? translations[this.$locale]\n        : translations[\"en\"]\n    );\n    this.el_list.appendChild(el_thead);\n\n    const status_key = this.el_status.value;\n    const cabinclass = {\n      Y: \"Economy\",\n      W: \"Premium Eco\",\n      C: \"Business\",\n      F: \"First\",\n    };\n\n    this.$segments.forEach((segment, index) => {\n      let earning = data[index].value.totals.find(\n        (item) => item.id == this.$program.value\n      );\n      console.log(earning);\n\n      if (earning == undefined) {\n        earning = { id: this.$program.value, qm: [0, 0], rdm: [0, 0] };\n      }\n\n      let rd_status_key = status_key;\n      status_key > earning.rdm.length - 1\n        ? (rd_status_key = earning.rdm.length - 1)\n        : {};\n\n      let qm_status_key = status_key;\n      status_key > earning.qm.length - 1\n        ? (qm_status_key = earning.qm.length - 1)\n        : {};\n\n      earning.rdm ? (totalrm += earning.rdm[rd_status_key]) : {};\n      earning.qm ? (totalqm += earning.qm[qm_status_key]) : {};\n\n      let el = document.createElement(\"tr\");\n      el.innerHTML = translate(\n        /*html*/ `\n        <td class=\"align-top text-vertical text-center text-xs text-grey-dark font-light\">${data[\n          index\n        ].value.distance?.toLocaleString()} __(miles)</td>\n        <td class=\"text-center\">\n          <div class=\"grid grid-cols-1 md:grid-cols-2\">\n            <div>\n              <div><code>${segment.origin}</code></div>\n              <div class=\"text-xs text-grey-dark font-light\">${\n                airports[segment.origin]?.location\n              }</div>\n            </div>\n            <div>\n              <div><code>${segment.destination}</code></div>\n              <div class=\"text-xs text-grey-dark font-light\">${\n                airports[segment.destination]?.location\n              }</div>\n            </div>\n          </div>\n        </td>\n        <td class=\"text-center\">\n          <div class=\"grid grid-cols-1 md:grid-cols-2\">\n            <div>\n              <div><code>${segment.carrier}</code></div>\n              <div class=\"text-xs text-grey-dark font-light\">${\n                airlines[segment.carrier]?.name\n              }</div>\n            </div>\n            <div>\n              <div><code>${segment.bookingClass}</code></div>\n              <div class=\"text-xs text-grey-dark font-light\">${\n                airlines[segment.carrier]?.bookingclass\n                  ? cabinclass[\n                      airlines[segment.carrier]?.bookingclass[\n                        segment.bookingClass\n                      ]?.cabinclass\n                    ]\n                  : \"\"\n              } ${\n          airlines[segment.carrier]?.bookingclass\n            ? airlines[segment.carrier]?.bookingclass.fare\n              ? airlines[segment.carrier]?.bookingclass[segment.bookingClass]\n                  ?.fare\n              : \"\"\n            : \"\"\n        }</div>\n            </div>\n          </div>\n        </td>\n        <td class=\"text-right\">${\n          false === data[index].success\n            ? data[index].errorMessage\n            : `${\n                earning.rdm ? earning.rdm[rd_status_key]?.toLocaleString() : \"-\"\n              }`\n        }</td>\n        <td class=\"text-right\">${\n          false === data[index].success\n            ? data[index].errorMessage\n            : `${earning.qm ? earning.qm[qm_status_key]?.toLocaleString() : 0}`\n        }</td>\n        `,\n        translations[this.$locale]\n          ? translations[this.$locale]\n          : translations[\"en\"]\n      );\n      this.el_list.appendChild(el);\n    });\n    let el_foot = document.createElement(\"tfoot\");\n\n    el_foot.innerHTML = translate(\n      /*html*/ `\n      <tr>\n        <th class=\"text-right\" colspan=\"3\">__(Total)</th>\n        <th class=\"text-right\">${totalrm.toLocaleString()}</th>\n        <th class=\"text-right\">${totalqm.toLocaleString()}</th>\n      </tr>\n    `,\n      translations[this.$locale]\n        ? translations[this.$locale]\n        : translations[\"en\"]\n    );\n    this.el_list.appendChild(el_foot);\n  }\n}\n"]}